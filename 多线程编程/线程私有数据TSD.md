## Thread Sepecific Data（TSD）

​		在多线程环境下，进程内的所有线程共享进程的数据空间，因此全局变量为所有线程共有。在程序设计中有时需要保存线程自己的全局变量，这种特殊的变量仅在某个线程内部有效。如常见的变量errno，它返回标准的出错代码。errno不应该是一个局部变量，几乎每个函数都应该可以访问它：但它又不能作为是一个全局变量，否则在一个线程里输出的很可能是另一个线程的出错信息，这个问题可以通过创建线程的私有数据（Thread—specific Data，或TSD）来解决。在线程内部，线程私有数据可以被各个函数访问，但它对其他线程是屏蔽的。

​	线程私有数据采用了一种被称为一键多值的技术，即一个键对应多个数值。访问数据时都是通过键值来访问，好像是对一个变量进行访问，其实是在访问不同的数据。使用线程私有数据时，首先要为每个线程数据创建一个相关联的键。在各个线程内部，都使用这个公用的键来指代线程数据，但是在不同的线程中，这个键代表的数据是不同的。

​		操作线程私有数据的函数主要有4个：

​		1、pthread＿key＿create（创建一个键）

​		2、pthread＿setspecific（为一个键设置线程私有数据）

​		3、pthread＿getspecific （从一个键读取线程私有数据）

​		4、pthread＿key＿delete（删除一个键）





参考：

https://blog.csdn.net/woxiaohahaa/article/details/78234911